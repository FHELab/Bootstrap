q = 140737488355201
t = 65537
correction_factor = pow(41471, -1, t)

def test(a, b, s):

    for j in range(32):
        res = b[j]
        # print(b[j])
        for i in range(j+1):
            res += a[i]*s[j-i]
            # if j == 0: 
                # print(a[i], s[j-i])
            res %= q
            # print('res', res)
        for i in range(j+1, 16):
            res += (q-a[i])*s[16+j - i]
            # if j == 0:
                # print(q-a[i], s[16+j - i])
            res %= q
            # print('res', res)
        # print('{:>5}'.format((res*correction_factor)%t), end='  ')
        print('{:>5}'.format((res)% t), end='  ')
    print('')
    
        
    # res = (b[0] + a[0]*s[0]) % q
    # for i in range(1,16):
    #     res -= a[i]*s[16-i]
    #     res %= q
        
    # res2 = (b[1] + a[0]*s[1] + a[1]*s[0]) % q
    # for i in range(2,16):
    #     if s[i] == 0:
    #         continue
    #     elif s[i] == 1:
    #         res2 -= a[17-i]
    #     else:
    #         res2 += a[17-i]
    #     res2 %= q
    
    # res3 = (b[2] + a[0]*s[2] + a[1]*s[1] + a[2]*s[0]) % q
    # for i in range(3,16):
    #     res3 -= a[i]*s[18-i]
    #     res3 %= q
    
    # print(res%t, res2%t, res3%t)



print("Test set with 1 as beginning:")
# print("Test set 1:")
b = [
5412905525074, 121165473311756, 15748740607795, 105230776944362, 22849915726232, 129322421278841, 39422890758136, 107586914856621, 131262511043546, 59254052016206, 24831309204823, 90403815532743, 69925746732743, 25080760951804, 985084454426, 133331788287913, 120732867998862, 11024750559696, 88359342638335, 7856108907024, 128898077573130, 7445227882749, 89816484829907, 128693811128223, 55520813699628, 111505311048436, 140002063228677, 131202886776304, 86865993925019, 28302532544247, 49891945547132, 92125333276923, 
]
a = [
48716517531330, 68288532370559, 52539791592923, 88046502805804, 65196586850636, 76611653756760, 37188763017389, 70339336637945, 79814313925083, 20560261858987, 136466441112054, 46062625602151, 116874367286808, 91793606623387, 90808522259089, 98214222272639, 118218842662552, 107194092076924, 18834749430176, 10978640545917, 22818051335264, 15372823439023, 66293826935689, 78337503911693, 22816689907950, 52048867034026, 52784291935009, 62318893456230, 116190387968536, 87887855556611, 37995910124419, 86608065163214, 
]
s = [
1, 140737488355200, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
]
test(a, b, s)




# 12455266613706 , 140737488355200 --> 94575750152258
# 120002009472221 , 1 --> 73840271269278
# 44962968722943 , 1 --> 118803239992221
# 31220084971507 , 1 --> 9285836608527
# 97745180408649--> 107031017017176

# 71190219304258 140737488355200
# 40293062120248 140737488355200
# 16093682430428 140737488355200
# 132557904594104 1

 # 1: 7150, 40046
 # 0: 32641, 0
 # 2: 14555, 47196
 # 3: 21705, 54601

 # 7150  14555  21705  29110   
 # 7150  14555  21705  29110   
 # 7150  47196  21705  61751  
 # 40046  14555  21705  29110
 # 7150  47196  21705  61751   
 # 7150  47196  21705  61751  
 # 40046  47196  21705  61751   
 # 7150  47196  21705  61751  
 # 7150  47196  21705  61751  
 # 40046  14555  21705  61751   
 # 7150  47196  54601  29110  
 # 40046  14555  21705  61751  
 # 7150  14555  54601  29110  
 # 40046  14555  54601  29110  
 # 40046  14555  54601  29110  
 # 40046  14555  54601  29110  
 # 40046  14555  54601  61751  
 # 40046  14555  21705  29110   
 # 7150  47196  21705  61751   
 # 7150  47196  21705  61751  






# print("Test set 2:")
# b = [234128258, 180578217, 18368179, 219753511, 51974408, 242360105, 255943410, 118143541, 195813445, 229620192, 36108974, 188021836, 124234631, 248795282, 157704711, 163253999]
# a = [218531211, 202455663, 39990748, 32293407, 180659892, 229354516, 163874146, 192107108, 99507168, 229548778, 19123869, 228868687, 121860697, 180823532, 118145662, 244923676]
# s = [0, 0, 268435360, 1, 268435360, 268435360, 1, 268435360, 0, 268435360, 268435360, 1, 268435360, 1, 0, 1]
# test(a, b, s)

# print("Test set 3:")
# b = [33287364, 118380693, 166426627, 167979479, 25869880, 219621206, 264509997, 75272138, 190853649, 13432687, 3639746, 109548400, 204693073, 147964621, 130727980, 76655836]
# a = [83892160, 191204299, 230251359, 141716904, 212910738, 50682089, 48784985, 81318010, 17693110, 65471460, 53212394, 217896787, 93642857, 93303897, 30611985, 170988403,]
# s = [268435360, 1, 1, 1, 0, 0, 0, 268435360, 0, 0, 0, 268435360, 0, 0, 1, 268435360]
# test(a, b, s)

# # print("Test set 4:")
# b = [202753956, 134169498, 117994954, 264594370, 130770951, 231457145, 124114658, 233064836, 254039541, 253659839, 244869915, 113579291, 109035985, 121433672, 1352716, 184058050]
# a = [93236797, 241279139, 182163805, 40563821, 160480491, 263225265, 19039140, 264428815, 100391990, 207930869, 145369246, 237123590, 201352151, 67504201, 246500585, 209895611]
# s = [1, 268435360, 0, 0, 1, 1, 0, 0, 268435360, 0, 1, 1, 0, 1, 268435360, 268435360]
# test(a, b, s)

# # print("Test set 5:")
# b = [3941402, 208414797, 133071011, 224082791, 185731195, 235508063, 216659638, 204977497, 257687415, 190141796, 246044571, 3289589, 80336200, 92818221, 265696680, 40364792]
# a = [144880749, 233228879, 194006440, 72142186, 186028078, 176275538, 247020469, 76353053, 124106537, 215003732, 255622194, 27509937, 242970614, 255631590, 194239923, 67607950]
# s = [268435360, 1, 268435360, 268435360, 268435360, 268435360, 268435360, 1, 0, 0, 0, 268435360, 268435360, 0, 268435360, 268435360]
# test(a, b, s)

# print("Test set with 0 as beginning:")
# # print("Test set 1:")
# b = [147929689,266732950,156838314,100630876,105495281,217258532,199091445,126241710,251222348,75563778,253006493,12823552,68822074,175832719,61649321,109856558]
# a = [79241983,207338810,83234624,176842363,261195450,110027874,44038404,177227406,144529335,80505509,130716135,69992924,116425851,110920043,49691885,4488017]
# s = [268435360,1,1,0,1,0,0,268435360,268435360,0,0,0,268435360,1,0,1]
# test(a, b, s)

# # print("Test set 2:")
# b = [203325732,267153267,243212206,105848855,268214685,262336397,10125995,197329210,107275459,112569331,195804813,210901421,20686099,14890788,22326609,104114256]
# a = [116948054,73124456,99452980,58928631,5171013,217872804,191041152,56375999,134814063,108131973,86696011,149447107,143627297,167883266,127257499,131898800]
# s = [0,1,1,1,268435360,268435360,0,268435360,268435360,1,1,268435360,0,268435360,0,1]
# test(a, b, s)

# # print("Test set 3:")
# b = [146895074,227402951,207265390,85988621,46904662,10893029,231193784,211274769,58905506,161694736,213372525,13403339,133208086,32399203,66120765,238267709]
# a = [156805632,158219303,248648606,28358312,153621991,81302668,188297801,115623740,232071509,23730047,220251944,217142117,227338034,204604924,26035694,241540029]
# s = [1,0,0,1,1,0,1,1,268435360,0,268435360,0,0,1,268435360,0]
# test(a, b, s)